<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>index</title>
    <script src="js/underscore.js"></script>
    <script src="js/sparrow-virtual-dom.js"></script>
    <script>
        var node = sparrow.node;
        var Container = sparrow.component({
            componentName: 'Container',
            handleClick: function () {
                var newItem = this.refs.userInput.value;
                var items = this.state.items;
                items.push({name: newItem});
//                this.setState({items:[{name:'test'}]})
                this.setState({items: items})
            },
            initialState: function () {
                return {items: [{name: 'eat', date: 'morning'}, {name: 'sex', date: 'night'}, {name: 'sex'}]}
            },
            render: function (p, s) {
                return node('div', null, [
                    node('div', null, [
                        node('input', {ref: 'userInput'}), node('button', {onClick: this.handleClick}, 'OK')
                    ]),
                    node(ToDoList, s)
                ])
            }
        });

        var ToDoList = sparrow.component({
            componentName: 'ToDoList',
            defaultProp: function () {
                return {id: 'to-do-list'}
            },
            render: function (p, s) {
                Items = p.items.map(function (item) {
                    return sparrow.node(ToDoItem, {item: item})
                });
                return sparrow.node('ul', {id: p.id}, Items)
            }
        });

        var ToDoItem = sparrow.component({
            componentName: 'ToDoItem',
            render: function (p, s) {
                return sparrow.node('li', null, p.item.name)
            }
        });


        var context = sparrow.defineContext({
            items: ['dd', 'll'],
            btn: 'it should be ok'
        });

        var A = sparrow.component({
            componentName: 'A',
            click: function () {
                context.update(this, {
                    items: ['DD', 'LL']
                })
            },
            render: function () {
//                console.log(this);
                var bs = context.items.map(function (item) {
                    return node(B, {name: item})
                });
                return node('div', null, bs);
//                return node('div',null,[node('button',{onclick:this.click},context.btn),node('div',null,bs)])
            }
        });

        var B = sparrow.component({
            componentName: 'B',
            click: function () {
//              this.setState({age:'234'})
            },
            render: function (p) {
                return node('p', {onclick: this.click}, p.name)
            }
        })
    </script>
</head>
<body>
<h3>to-do-list</h3>

<div id="c"></div>
<!--<button onclick="update()">update</button>-->
</body>
<script>
    /*var container = Container.paint();
     var c = document.getElementById('c');
     sparrow.mount(container, c);*/
    var a = A.paint();
    var c = document.getElementById('c');
    sparrow.mount(a, c);


</script>
</html>