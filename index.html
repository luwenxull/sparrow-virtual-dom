<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>index</title>
    <script src="js/underscore.js"></script>
    <script src="js/sparrow-virtual-dom.js"></script>
</head>
<body>
<div id="one"></div>
<div id="two"></div>
</body>
<script>
    var messenger=sparrow.defineMessenger({
        data:{
            date:'2016-12'
        }
    });

    var node=sparrow.createNode;
    var A = sparrow.createComponent({
        componentName: 'A',
        willMount:function(){
            this.sub('delete',function(message,from){
                console.log(message,from)
            })
        },
        handleClick: function (event) {
//                console.log(this,event)
            this.setState({
                bs:['Some body','ddddf','djjljlj']
            });
        },
        defaultProp: function () {
            return {age: '11'}
        },
        initialState: function () {
            return {bs:['lu','dai']}
        },
        render: function () {
            var bs=this.state.bs.map(function(b){
                return node(B,{name:b})
            });
            var arr=bs.concat(node('button',{onClick:this.handleClick},'click to update'));
            return node('div', {className:'a'}, arr)

        }
    });

    var B = sparrow.createComponent({
        componentName: 'B',
        handleClick: function (event) {
            this.setState({location:'nantong'});
            this.pub('delete','1');
        },
        initialState: function () {
            return {location:'suzhou'}
        },
        render: function () {
            return node('p', {onClick: this.handleClick,ref:'p'}, [this.prop.name,this.state.location])
        }
    });

    var C = sparrow.createComponent({
        componentName: 'C',
        render: function () {
            return node(A)
        }
    });
    var a = node(C);
    //    sparrow.with()

    //    console.log(tree(a),tree(a2));
    //    console.log(diffTwoNodes(a,a2));

    sparrow.mount(a, document.getElementById('one'));
</script>
</html>